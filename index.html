<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>ARãƒ¢ãƒ‡ãƒ«è¡¨ç¤ºï¼ˆè·é›¢è¡¨ç¤ºã¤ãï¼‰</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        font-family: "Helvetica Neue", sans-serif;
        background-color: #f7f9fc;
        color: #333;
        text-align: center;
      }

      h1 {
        margin-top: 1.2rem;
        font-size: 1.4rem;
      }

      a[rel="ar"] img {
        width: 220px;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        transition: transform 0.2s, box-shadow 0.2s;
        margin-top: 1rem;
      }

      a[rel="ar"] img:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
      }

      .coords {
        margin-top: 1.2rem;
        background: #ffffffb3;
        padding: 10px 16px;
        border-radius: 8px;
        font-size: 0.95rem;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }

      iframe {
        width: 90%;
        max-width: 500px;
        height: 300px;
        border: none;
        border-radius: 12px;
        margin: 1.2rem 0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      footer {
        font-size: 0.8rem;
        color: #777;
        margin-bottom: 1rem;
      }
    </style>
  </head>

  <body>
    <h1>ARã§ãƒ¢ãƒ‡ãƒ«ã‚’è¦‹ã‚‹</h1>

    <!-- Quick Look ãƒªãƒ³ã‚¯ -->
    <a href="model.usdz" rel="ar">
      <img src="thumbnail.jpg" alt="ARã§è¡¨ç¤º" />
    </a>

    <div class="coords">
      ğŸ“ ãƒ¢ãƒ‡ãƒ«ã®ä½ç½®ï¼š<br />
      ç·¯åº¦ï¼š36.50516184328213<br />
      çµŒåº¦ï¼š138.11215639377093
      <br /><br />
      ğŸ“ ã‚ãªãŸã®ç¾åœ¨åœ°ã¨ã®è·é›¢ï¼š<span id="distance">è¨ˆæ¸¬ä¸­...</span>
    </div>

    <!-- Google Map åŸ‹ã‚è¾¼ã¿ï¼ˆãƒ”ãƒ³ä»˜ãï¼‰ -->
    <iframe
      src="https://www.google.com/maps?q=36.50516184328213,138.11215639377093&z=18&output=embed"
      allowfullscreen
      loading="lazy"
    ></iframe>

    <footer>iPhoneã®Safariã§é–‹ãã¨ARã§åºŠé¢ã«è¡¨ç¤ºã•ã‚Œã¾ã™</footer>

    <script>
      // ãƒ¢ãƒ‡ãƒ«ã®ä½ç½®ï¼ˆå›ºå®šï¼‰
      const modelLat = 36.50516184328213;
      const modelLng = 138.11215639377093;

      // è·é›¢è¨ˆç®—é–¢æ•°ï¼ˆãƒâ€•ãƒãƒ¼ã‚·ãƒ³å…¬å¼ï¼‰
      function calcDistance(lat1, lon1, lat2, lon2) {
        const R = 6371e3; // åœ°çƒã®åŠå¾„ï¼ˆãƒ¡ãƒ¼ãƒˆãƒ«ï¼‰
        const toRad = (x) => (x * Math.PI) / 180;
        const Ï†1 = toRad(lat1);
        const Ï†2 = toRad(lat2);
        const Î”Ï† = toRad(lat2 - lat1);
        const Î”Î» = toRad(lon2 - lon1);

        const a =
          Math.sin(Î”Ï† / 2) * Math.sin(Î”Ï† / 2) +
          Math.cos(Ï†1) * Math.cos(Ï†2) *
          Math.sin(Î”Î» / 2) * Math.sin(Î”Î» / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

        return R * c; // è·é›¢ï¼ˆmï¼‰
      }

      // ç¾åœ¨åœ°ã‚’å–å¾—ã—ã¦è·é›¢ã‚’è¡¨ç¤º
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (pos) => {
            const userLat = pos.coords.latitude;
            const userLng = pos.coords.longitude;
            const dist = calcDistance(userLat, userLng, modelLat, modelLng);
            const distanceText =
              dist < 1000
                ? `${dist.toFixed(1)} m`
                : `${(dist / 1000).toFixed(2)} km`;
            document.getElementById("distance").textContent = distanceText;
          },
          (err) => {
            document.getElementById("distance").textContent =
              "ç¾åœ¨åœ°ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ";
          },
          { enableHighAccuracy: true, timeout: 8000 }
        );
      } else {
        document.getElementById("distance").textContent =
          "ä½ç½®æƒ…å ±ã«éå¯¾å¿œã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã™";
      }
    </script>
  </body>
</html>
