<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AR施工モデル</title>

<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #fafafa;
  text-align: center;
}

h1 {
  margin: 12px 0;
  font-size: 18px;
}

model-viewer {
  width: 100%;
  height: 65vh;
  background: #eaeaea;
}

.controls {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 6px;
  padding: 10px;
}

button {
  padding: 10px;
  border: none;
  border-radius: 6px;
  background: #007bff;
  color: white;
  font-size: 14px;
}

button.gray {
  background: #666;
}

footer {
  font-size: 12px;
  color: #666;
  padding-bottom: 10px;
}
</style>
</head>

<body>

<h1 id="title">完成モデル（令和7年度 予防治山事業 第13号）</h1>

<model-viewer id="viewer"
  src="model.glb"
  camera-controls
  environment-image="neutral"

  ar
  ar-modes="webxr scene-viewer quick-look"
  ar-scale="fixed"
  shadow-intensity="0.5">
</model-viewer>

<div class="controls">
  <button onclick="move(0,0,-0.1)">↑ 前</button>
  <button onclick="rotate(-5)">↺ 回転</button>
  <button onclick="move(0,0,0.1)">↓ 後</button>

  <button onclick="move(-0.1,0,0)">← 左</button>
  <button class="gray" onclick="reset()">リセット</button>
  <button onclick="move(0.1,0,0)">右 →</button>

  <button onclick="move(0,0.1,0)">＋ 高</button>
  <button onclick="toggleModel()">切替</button>
  <button onclick="move(0,-0.1,0)">－ 低</button>
</div>

<footer>
地面をタップして配置 → ボタンで微調整してください
</footer>

<script>
const viewer = document.getElementById("viewer");
const title = document.getElementById("title");

let showingModel = "model";
let pos = { x: 0, y: 0, z: 0 };
let rotY = 0;

function updateTransform() {
  viewer.style.transform =
    `translate3d(${pos.x}px, ${pos.y}px, ${pos.z}px) rotateY(${rotY}deg)`;
}

function move(dx, dy, dz) {
  pos.x += dx * 100;
  pos.y -= dy * 100;
  pos.z += dz * 100;
  updateTransform();
}

function rotate(deg) {
  rotY += deg;
  updateTransform();
}

function reset() {
  pos = { x: 0, y: 0, z: 0 };
  rotY = 0;
  updateTransform();
}

function toggleModel() {
  if (showingModel === "model") {
    viewer.src = "model2.glb";
    title.textContent = "土工モデル（令和7年度 予防治山事業 第13号）";
    showingModel = "model2";
  } else {
    viewer.src = "model.glb";
    title.textContent = "完成モデル（令和7年度 予防治山事業 第13号）";
    showingModel = "model";
  }
}
</script>

</body>
</html>
